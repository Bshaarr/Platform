<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Ù…Ù†ØµØ© Ù…ÙˆØ±ÙˆÙƒØ³ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© - Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap');
        
        * {
            font-family: 'Cairo', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .robot-animation {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .fade-in {
            animation: fadeIn 0.8s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .notification {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        .certificate-bg {
            background: linear-gradient(45deg, #f3ec78, #af4261);
        }
        
        .admin-panel {
            background: linear-gradient(135deg, #1e3a8a 0%, #7c3aed 100%);
            min-height: 100vh;
        }
        
        .admin-card {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .certificate-template {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: 8px solid #ffd700;
            position: relative;
            overflow: hidden;
        }
        
        .certificate-template::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
        }
        
        .certificate-seal {
            position: absolute;
            bottom: 30px;
            right: 30px;
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, #ffd700, #ffed4e);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
        }
        
        .stats-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0.1) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease;
        }
        
        .stats-card:hover {
            transform: translateY(-5px);
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.15) 100%);
        }
        
        .admin-nav-btn {
            transition: all 0.3s ease;
        }
        
        .admin-nav-btn:hover {
            background: rgba(255,255,255,0.2) !important;
            color: white !important;
        }
        
        .admin-nav-btn.active {
            background: rgba(255,255,255,0.2) !important;
            color: white !important;
        }
        
        .form-input {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            backdrop-filter: blur(10px);
        }
        
        .form-input::placeholder {
            color: rgba(255,255,255,0.7);
        }
        
        .form-input:focus {
            background: rgba(255,255,255,0.15);
            border-color: rgba(255,255,255,0.4);
            outline: none;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            transition: all 0.3s ease;
        }
        
        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(239, 68, 68, 0.3);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            transition: all 0.3s ease;
        }
        
        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(245, 158, 11, 0.3);
        }
        
        .modal-backdrop {
            backdrop-filter: blur(5px);
            background: rgba(0,0,0,0.5);
        }
        
        .course-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease;
        }
        
        .course-card:hover {
            transform: translateY(-5px);
            background: linear-gradient(135deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0.1) 100%);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Notifications Container -->
    <div id="notifications" class="fixed top-4 left-4 z-50 space-y-2"></div>

    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen gradient-bg flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md fade-in">
            <div class="text-center mb-8">
                <div class="robot-animation text-6xl mb-4">ğŸ¤–</div>
                <h1 class="text-3xl font-bold text-gray-800 mb-3">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…ÙˆØ±ÙˆÙƒØ³</h1>
                <p class="text-gray-600">Ù…Ù†ØµØ© ØªØ¯Ø±ÙŠØ¨ Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</p>
            </div>
            
            <form id="loginForm" class="space-y-6">
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
                    <input type="text" id="studentName" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                           placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„">
                </div>
                
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                    <input type="tel" id="studentPhone" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                           placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ">
                </div>
                
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                    <input type="email" id="studentEmail" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                           placeholder="Ø£Ø¯Ø®Ù„ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
                </div>
                
                <button type="submit" 
                        class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-4 rounded-lg font-semibold hover:shadow-lg transition-all text-lg">
                    Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ù†ØµØ©
                </button>
            </form>

            <!-- Admin Login Button -->
            <div class="mt-6 pt-6 border-t border-gray-200">
                <button type="button" onclick="showAdminLogin()"
                        class="w-full bg-gradient-to-r from-red-600 to-pink-600 text-white py-3 rounded-lg font-semibold hover:shadow-lg transition-all">
                    <i class="fas fa-user-shield mr-2"></i>Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ±
                </button>
            </div>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="adminLoginModal" class="fixed inset-0 modal-backdrop z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md">
            <div class="text-center mb-6">
                <div class="text-5xl mb-4">ğŸ›¡ï¸</div>
                <h2 class="text-2xl font-bold text-gray-800">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ±</h2>
            </div>
            
            <form id="adminLoginForm" class="space-y-4">
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                    <input type="text" id="adminUsername" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all"
                           placeholder="Bashar">
                </div>
                
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" id="adminPassword" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all"
                           placeholder="bbsshhaarr6405">
                </div>
                
                <div class="flex space-x-3 space-x-reverse">
                    <button type="submit" 
                            class="flex-1 bg-gradient-to-r from-red-600 to-pink-600 text-white py-3 rounded-lg font-semibold hover:shadow-lg transition-all">
                        Ø¯Ø®ÙˆÙ„
                    </button>
                    <button type="button" onclick="hideAdminLogin()"
                            class="flex-1 bg-gray-500 text-white py-3 rounded-lg font-semibold hover:shadow-lg transition-all">
                        Ø¥Ù„ØºØ§Ø¡
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Main Website -->
    <div id="mainWebsite" class="hidden">
        <!-- Header -->
        <header class="bg-white shadow-lg sticky top-0 z-40">
            <div class="px-4 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3 space-x-reverse">
                        <div class="text-3xl">ğŸ¤–</div>
                        <div>
                            <h1 class="text-xl font-bold text-gray-800">Ù…ÙˆØ±ÙˆÙƒØ³</h1>
                            <p class="text-sm text-gray-600">Ù…Ù†ØµØ© ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center space-x-3 space-x-reverse">
                        <span class="text-sm text-gray-600">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ <span id="welcomeName" class="font-semibold text-blue-600"></span></span>
                        <button onclick="logout()" class="text-gray-600 hover:text-red-600 p-2 transition-colors">
                            <i class="fas fa-sign-out-alt text-lg"></i>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="bg-gray-100 border-b border-gray-200">
            <div class="px-4 py-3">
                <div class="flex space-x-1 space-x-reverse overflow-x-auto">
                    <button onclick="showSection('dashboard')" class="nav-btn bg-blue-50 text-blue-600 px-6 py-3 rounded-lg font-semibold whitespace-nowrap transition-all">
                        <i class="fas fa-home mr-2"></i>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                    </button>
                    <button onclick="showSection('courses')" class="nav-btn text-gray-700 px-6 py-3 rounded-lg font-semibold whitespace-nowrap transition-all hover:bg-gray-200">
                        <i class="fas fa-book mr-2"></i>Ø§Ù„Ø¯ÙˆØ±Ø§Øª
                    </button>
                    <button onclick="showSection('quiz')" class="nav-btn text-gray-700 px-6 py-3 rounded-lg font-semibold whitespace-nowrap transition-all hover:bg-gray-200">
                        <i class="fas fa-question-circle mr-2"></i>Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
                    </button>
                    <button onclick="showSection('certificates')" class="nav-btn text-gray-700 px-6 py-3 rounded-lg font-semibold whitespace-nowrap transition-all hover:bg-gray-200">
                        <i class="fas fa-certificate mr-2"></i>Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª
                    </button>
                </div>
            </div>
        </nav>

        <!-- Dashboard Section -->
        <section id="dashboardSection" class="py-8">
            <div class="px-4 max-w-6xl mx-auto">
                <!-- Welcome Card -->
                <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white p-8 rounded-2xl text-center mb-8 card-hover">
                    <div class="text-5xl mb-4">ğŸ‰</div>
                    <h2 class="text-3xl font-bold mb-3">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ <span id="welcomeName2" class="text-yellow-300"></span>!</h2>
                    <p class="text-lg opacity-90 mb-6">ÙÙŠ Ù…Ù†ØµØ© Ù…ÙˆØ±ÙˆÙƒØ³ Ù„ØªØ¯Ø±ÙŠØ¨ Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</p>
                    <div class="grid grid-cols-3 gap-4 text-center">
                        <div>
                            <div class="text-2xl font-bold">12+</div>
                            <div class="text-sm opacity-80">Ø¯ÙˆØ±Ø© ØªØ¯Ø±ÙŠØ¨ÙŠØ©</div>
                        </div>
                        <div>
                            <div class="text-2xl font-bold">500+</div>
                            <div class="text-sm opacity-80">Ø·Ø§Ù„Ø¨ Ù…Ø³Ø¬Ù„</div>
                        </div>
                        <div>
                            <div class="text-2xl font-bold">95%</div>
                            <div class="text-sm opacity-80">Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­</div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                    <button onclick="showSection('courses')" class="bg-white p-6 rounded-xl shadow-lg text-center card-hover border-l-4 border-blue-500">
                        <div class="text-4xl mb-4 text-blue-500">ğŸ“š</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">ØªØµÙØ­ Ø§Ù„Ø¯ÙˆØ±Ø§Øª</h3>
                        <p class="text-gray-600">Ø§ÙƒØªØ´Ù Ø¯ÙˆØ±Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© ÙÙŠ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</p>
                    </button>
                    
                    <button onclick="showSection('quiz')" class="bg-white p-6 rounded-xl shadow-lg text-center card-hover border-l-4 border-green-500">
                        <div class="text-4xl mb-4 text-green-500">ğŸ§ </div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Ø§Ø®ØªØ¨Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ</h3>
                        <p class="text-gray-600">Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ØªÙØ§Ø¹Ù„ÙŠØ© ÙˆÙ…ØªÙ†ÙˆØ¹Ø©</p>
                    </button>
                    
                    <button onclick="showSection('certificates')" class="bg-white p-6 rounded-xl shadow-lg text-center card-hover border-l-4 border-yellow-500">
                        <div class="text-4xl mb-4 text-yellow-500">ğŸ†</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø´Ù‡Ø§Ø¯Ø©</h3>
                        <p class="text-gray-600">Ø´Ù‡Ø§Ø¯Ø§Øª Ù…Ø¹ØªÙ…Ø¯Ø© Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§ØªÙƒ</p>
                    </button>
                </div>
            </div>
        </section>

        <!-- Courses Section -->
        <section id="coursesSection" class="hidden py-8">
            <div class="px-4 max-w-6xl mx-auto">
                <div class="text-center mb-8">
                    <h2 class="text-4xl font-bold text-gray-800 mb-4">Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ©</h2>
                    <p class="text-xl text-gray-600">Ø§Ø®ØªØ± Ù…Ù† Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…ØªÙ†ÙˆØ¹Ø© Ù…Ù† Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</p>
                </div>
                
                <div id="coursesList" class="grid gap-8">
                    <!-- Courses will be loaded here -->
                </div>
            </div>
        </section>

        <!-- Quiz Section -->
        <section id="quizSection" class="hidden py-8">
            <div class="px-4 max-w-6xl mx-auto">
                <div class="text-center mb-8">
                    <h2 class="text-4xl font-bold text-gray-800 mb-4">Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</h2>
                    <p class="text-xl text-gray-600">Ø§Ø®ØªØ¨Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ ÙÙŠ Ù…Ø¬Ø§Ù„ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</p>
                </div>
                
                <div class="grid gap-8">
                    <div class="bg-white p-8 rounded-2xl shadow-lg card-hover">
                        <div class="flex items-center mb-6">
                            <div class="text-5xl mr-6">ğŸ§ </div>
                            <div>
                                <h3 class="text-2xl font-bold text-gray-800">Ø§Ø®ØªØ¨Ø§Ø± Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</h3>
                                <p class="text-gray-600 text-lg">Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„ Ø­ÙˆÙ„ Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</p>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <div class="text-gray-500 space-x-4 space-x-reverse">
                                <span class="inline-flex items-center"><i class="fas fa-clock mr-2"></i>15 Ø¯Ù‚ÙŠÙ‚Ø©</span>
                                <span class="inline-flex items-center"><i class="fas fa-question-circle mr-2"></i>10 Ø£Ø³Ø¦Ù„Ø©</span>
                                <span class="inline-flex items-center"><i class="fas fa-star mr-2"></i>100 Ù†Ù‚Ø·Ø©</span>
                            </div>
                            <button class="bg-blue-500 hover:bg-blue-600 text-white px-8 py-3 rounded-lg font-semibold transition-all">
                                Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-white p-8 rounded-2xl shadow-lg card-hover">
                        <div class="flex items-center mb-6">
                            <div class="text-5xl mr-6">ğŸ¤–</div>
                            <div>
                                <h3 class="text-2xl font-bold text-gray-800">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø¢Ù„ÙŠ</h3>
                                <p class="text-gray-600 text-lg">Ø§Ø®ØªØ¨Ø§Ø± Ù…ØªÙ‚Ø¯Ù… ÙÙŠ Ù…Ø¬Ø§Ù„ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø¢Ù„ÙŠ</p>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <div class="text-gray-500 space-x-4 space-x-reverse">
                                <span class="inline-flex items-center"><i class="fas fa-clock mr-2"></i>20 Ø¯Ù‚ÙŠÙ‚Ø©</span>
                                <span class="inline-flex items-center"><i class="fas fa-question-circle mr-2"></i>15 Ø£Ø³Ø¦Ù„Ø©</span>
                                <span class="inline-flex items-center"><i class="fas fa-star mr-2"></i>150 Ù†Ù‚Ø·Ø©</span>
                            </div>
                            <button class="bg-green-500 hover:bg-green-600 text-white px-8 py-3 rounded-lg font-semibold transition-all">
                                Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Certificates Section -->
        <section id="certificatesSection" class="hidden py-8">
            <div class="px-4 max-w-6xl mx-auto">
                <div class="text-center mb-8">
                    <h2 class="text-4xl font-bold text-gray-800 mb-4">Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª</h2>
                    <p class="text-xl text-gray-600">Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø´Ù‡Ø§Ø¯Ø§Øª Ù…Ø¹ØªÙ…Ø¯Ø© Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§ØªÙƒ</p>
                </div>
                
                <!-- Request Certificate for Registered Courses -->
                <div class="mb-8">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">Ø·Ù„Ø¨ Ø´Ù‡Ø§Ø¯Ø© Ù„Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ù…Ø³Ø¬Ù„ Ø¨Ù‡Ø§</h3>
                    <div id="availableCertificates" class="grid gap-6">
                        <!-- Available certificates will be loaded here -->
                    </div>
                </div>
                
                <!-- User's Approved Certificates -->
                <div class="mb-8">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">Ø´Ù‡Ø§Ø¯Ø§ØªÙŠ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©</h3>
                    <div id="userApprovedCertificates" class="grid gap-6">
                        <!-- Approved certificates will be loaded here -->
                    </div>
                </div>
                
                <!-- Pending Certificate Requests -->
                <div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©</h3>
                    <div id="pendingCertificatesList">
                        <!-- Pending requests will be loaded here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="bg-gray-800 text-white py-12">
            <div class="container mx-auto px-4 max-w-6xl">
                <div class="text-center mb-8">
                    <div class="text-4xl mb-4">ğŸ¤–</div>
                    <h4 class="text-2xl font-bold mb-4">Ù…Ù†ØµØ© Ù…ÙˆØ±ÙˆÙƒØ³ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</h4>
                    <p class="text-gray-400 text-lg mb-6">ØªØ¯Ø±ÙŠØ¨ Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø¨Ø£Ø³Ù„ÙˆØ¨ Ù…Ù…ØªØ¹ ÙˆØ¨Ø³ÙŠØ·</p>
                </div>
                
                <div class="grid md:grid-cols-3 gap-8 mb-8">
                    <div>
                        <h5 class="font-bold text-lg mb-4">Ø±ÙˆØ§Ø¨Ø· Ø³Ø±ÙŠØ¹Ø©</h5>
                        <ul class="space-y-3 text-gray-400">
                            <li><a href="#" onclick="showSection('courses')" class="hover:text-white transition-colors">Ø§Ù„Ø¯ÙˆØ±Ø§Øª</a></li>
                            <li><a href="#" onclick="showSection('quiz')" class="hover:text-white transition-colors">Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</a></li>
                            <li><a href="#" onclick="showSection('certificates')" class="hover:text-white transition-colors">Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª</a></li>
                        </ul>
                    </div>
                    
                    <div>
                        <h5 class="font-bold text-lg mb-4">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h5>
                        <div class="space-y-3">
                            <a href="https://www.facebook.com/share/1GmdvSKcuU/" target="_blank" class="flex items-center text-gray-400 hover:text-white transition-colors">
                                <i class="fab fa-facebook mr-3 text-xl"></i>ÙÙŠØ³Ø¨ÙˆÙƒ
                            </a>
                            <a href="https://www.instagram.com/morox732?igsh=ajBlbW1jdHpweTdu" target="_blank" class="flex items-center text-gray-400 hover:text-white transition-colors">
                                <i class="fab fa-instagram mr-3 text-xl"></i>Ø¥Ù†Ø³ØªØºØ±Ø§Ù…
                            </a>
                            <a href="https://youtube.com/@morox732?si=IXRA6Jv8ut7L5Bvb" target="_blank" class="flex items-center text-gray-400 hover:text-white transition-colors">
                                <i class="fab fa-youtube mr-3 text-xl"></i>ÙŠÙˆØªÙŠÙˆØ¨
                            </a>
                            <a href="https://chat.whatsapp.com/FJnj4j3bMhJ15d7XhUBmgl?mode=ac_t" target="_blank" class="flex items-center text-gray-400 hover:text-white transition-colors">
                                <i class="fab fa-whatsapp mr-3 text-xl"></i>ÙˆØ§ØªØ³Ø§Ø¨
                            </a>
                        </div>
                    </div>
                    
                    <div>
                        <h5 class="font-bold text-lg mb-4">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù†ØµØ©</h5>
                        <p class="text-gray-400">Ù…Ù†ØµØ© Ù…ÙˆØ±ÙˆÙƒØ³ Ù‡ÙŠ Ù…Ù†ØµØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ù…ØªØ®ØµØµØ© ÙÙŠ ØªØ¯Ø±ÙŠØ¨ Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„Ù„Ø·Ù„Ø§Ø¨ ÙˆØ§Ù„Ù…Ù‡Ù†ÙŠÙŠÙ†.</p>
                    </div>
                </div>
                
                <div class="text-center pt-8 border-t border-gray-700">
                    <p class="text-gray-500">Â© 2024 Ù…Ù†ØµØ© Ù…ÙˆØ±ÙˆÙƒØ³ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
                    <p class="text-gray-400 mt-2">ØªØ­Øª Ø¥Ø´Ø±Ø§Ù: Ù…. Ø¨Ø´Ø§Ø± Ø¹Ù†ÙŠØ²Ø§Ù†</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="hidden admin-panel">
        <!-- Admin Header -->
        <header class="bg-white/10 backdrop-blur-md border-b border-white/20 sticky top-0 z-40">
            <div class="px-6 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4 space-x-reverse">
                        <div class="text-3xl">ğŸ›¡ï¸</div>
                        <div>
                            <h1 class="text-xl font-bold text-white">Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¯ÙŠØ±</h1>
                            <p class="text-sm text-white/70">Ù…. Ø¨Ø´Ø§Ø± Ø¹Ù†ÙŠØ²Ø§Ù† - Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ù†ØµØ©</p>
                        </div>
                    </div>
                    
                    <button onclick="logoutAdmin()" class="text-white/70 hover:text-white p-3 rounded-lg transition-colors">
                        <i class="fas fa-sign-out-alt text-xl"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Admin Content -->
        <div class="px-6 py-8">
            <!-- Admin Navigation -->
            <div class="mb-8">
                <div class="flex space-x-2 space-x-reverse overflow-x-auto pb-2">
                    <button onclick="showAdminSection('stats')" class="admin-nav-btn active px-6 py-3 rounded-lg font-semibold whitespace-nowrap transition-all">
                        <i class="fas fa-chart-bar mr-2"></i>Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                    </button>
                    <button onclick="showAdminSection('courses')" class="admin-nav-btn text-white/70 px-6 py-3 rounded-lg font-semibold whitespace-nowrap transition-all">
                        <i class="fas fa-book mr-2"></i>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯ÙˆØ±Ø§Øª
                    </button>
                    <button onclick="showAdminSection('announcements')" class="admin-nav-btn text-white/70 px-6 py-3 rounded-lg font-semibold whitespace-nowrap transition-all">
                        <i class="fas fa-bullhorn mr-2"></i>Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
                    </button>
                    <button onclick="showAdminSection('certificates')" class="admin-nav-btn text-white/70 px-6 py-3 rounded-lg font-semibold whitespace-nowrap transition-all">
                        <i class="fas fa-certificate mr-2"></i>Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª
                    </button>
                    <button onclick="showAdminSection('users')" class="admin-nav-btn text-white/70 px-6 py-3 rounded-lg font-semibold whitespace-nowrap transition-all">
                        <i class="fas fa-users mr-2"></i>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
                    </button>
                </div>
            </div>

            <!-- Stats Section -->
            <div id="adminStatsSection" class="admin-section">
                <!-- Stats Cards -->
                <div class="grid grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="stats-card rounded-xl p-6 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white/70 text-sm mb-1">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</p>
                                <p class="text-3xl font-bold" id="totalUsersCount">0</p>
                            </div>
                            <div class="text-4xl opacity-70">ğŸ‘¥</div>
                        </div>
                    </div>
                    
                    <div class="stats-card rounded-xl p-6 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white/70 text-sm mb-1">Ø§Ù„ØªØ³Ø¬ÙŠÙ„Ø§Øª</p>
                                <p class="text-3xl font-bold" id="totalRegistrationsCount">0</p>
                            </div>
                            <div class="text-4xl opacity-70">ğŸ“</div>
                        </div>
                    </div>
                    
                    <div class="stats-card rounded-xl p-6 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white/70 text-sm mb-1">Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª</p>
                                <p class="text-3xl font-bold" id="pendingCertificatesCount">0</p>
                            </div>
                            <div class="text-4xl opacity-70">â³</div>
                        </div>
                    </div>
                    
                    <div class="stats-card rounded-xl p-6 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white/70 text-sm mb-1">Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØµØ¯Ø±Ø©</p>
                                <p class="text-3xl font-bold" id="totalCertificatesCount">0</p>
                            </div>
                            <div class="text-4xl opacity-70">ğŸ†</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Courses Management Section -->
            <div id="adminCoursesSection" class="admin-section hidden">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-bold text-white">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯ÙˆØ±Ø§Øª</h3>
                    <button onclick="showAddCourseModal()" class="btn-primary text-white px-6 py-3 rounded-lg font-semibold">
                        <i class="fas fa-plus mr-2"></i>Ø¥Ø¶Ø§ÙØ© Ø¯ÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©
                    </button>
                </div>
                
                <div id="adminCoursesList" class="grid gap-6">
                    <!-- Courses will be loaded here -->
                </div>
            </div>

            <!-- Announcements Management Section -->
            <div id="adminAnnouncementsSection" class="admin-section hidden">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-bold text-white">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</h3>
                    <button onclick="showAddAnnouncementModal()" class="btn-primary text-white px-6 py-3 rounded-lg font-semibold">
                        <i class="fas fa-plus mr-2"></i>Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø¯ÙŠØ¯
                    </button>
                </div>
                
                <div id="adminAnnouncementsList" class="grid gap-6">
                    <!-- Announcements will be loaded here -->
                </div>
            </div>

            <!-- Certificate Management Section -->
            <div id="adminCertificatesSection" class="admin-section hidden">
                <div class="admin-card rounded-xl p-6 mb-6">
                    <h3 class="text-xl font-bold text-white mb-4">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª</h3>
                    
                    <!-- Pending Certificate Requests -->
                    <div class="mb-6">
                        <h4 class="text-lg font-semibold text-white mb-3">Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©</h4>
                        <div id="pendingCertificatesAdmin" class="space-y-3">
                            <!-- Pending certificates will be loaded here -->
                        </div>
                    </div>
                    
                    <!-- Approved Certificates -->
                    <div>
                        <h4 class="text-lg font-semibold text-white mb-3">Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©</h4>
                        <div id="approvedCertificatesAdmin" class="space-y-3">
                            <!-- Approved certificates will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Users Management Section -->
            <div id="adminUsersSection" class="admin-section hidden">
                <div class="admin-card rounded-xl p-6">
                    <h3 class="text-xl font-bold text-white mb-4">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
                    <div id="usersList" class="space-y-3">
                        <!-- Users will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Course Modal -->
    <div id="addCourseModal" class="fixed inset-0 modal-backdrop z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-gray-800">Ø¥Ø¶Ø§ÙØ© Ø¯ÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©</h2>
                <button onclick="hideAddCourseModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="addCourseForm" class="space-y-4">
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯ÙˆØ±Ø©</label>
                    <input type="text" id="courseTitle" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                           placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯ÙˆØ±Ø©">
                </div>
                
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">ÙˆØµÙ Ø§Ù„Ø¯ÙˆØ±Ø©</label>
                    <textarea id="courseDescription" required rows="3"
                              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                              placeholder="Ø£Ø¯Ø®Ù„ ÙˆØµÙ Ø§Ù„Ø¯ÙˆØ±Ø©"></textarea>
                </div>
                
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø¨</label>
                    <input type="text" id="courseInstructor" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                           placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø¨">
                </div>
                
                <div class="grid grid-cols-3 gap-4">
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Ø¹Ø¯Ø¯ Ø§Ù„Ø¯Ø±ÙˆØ³</label>
                        <input type="number" id="courseLessons" required min="1"
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                               placeholder="12">
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª</label>
                        <input type="number" id="courseHours" required min="1"
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                               placeholder="8">
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 font-semibold mb-2">Ø§Ù„Ø³Ø¹Ø± (Ø±ÙŠØ§Ù„)</label>
                        <input type="number" id="coursePrice" required min="0"
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                               placeholder="299">
                    </div>
                </div>
                
                <div class="flex space-x-3 space-x-reverse pt-4">
                    <button type="submit" class="flex-1 btn-primary text-white py-3 rounded-lg font-semibold">
                        Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙˆØ±Ø©
                    </button>
                    <button type="button" onclick="hideAddCourseModal()" class="flex-1 bg-gray-500 text-white py-3 rounded-lg font-semibold">
                        Ø¥Ù„ØºØ§Ø¡
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Announcement Modal -->
    <div id="addAnnouncementModal" class="fixed inset-0 modal-backdrop z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-2xl">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-gray-800">Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø¯ÙŠØ¯</h2>
                <button onclick="hideAddAnnouncementModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="addAnnouncementForm" class="space-y-4">
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</label>
                    <input type="text" id="announcementTitle" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                           placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†">
                </div>
                
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</label>
                    <textarea id="announcementContent" required rows="4"
                              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                              placeholder="Ø£Ø¯Ø®Ù„ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†"></textarea>
                </div>
                
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</label>
                    <select id="announcementType" required 
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        <option value="info">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ø§Ù…Ø©</option>
                        <option value="success">Ø¥Ù†Ø¬Ø§Ø² Ø£Ùˆ Ù†Ø¬Ø§Ø­</option>
                        <option value="warning">ØªØ­Ø°ÙŠØ± Ø£Ùˆ ØªÙ†Ø¨ÙŠÙ‡</option>
                        <option value="error">Ø®Ø·Ø£ Ø£Ùˆ Ù…Ø´ÙƒÙ„Ø©</option>
                    </select>
                </div>
                
                <div class="flex space-x-3 space-x-reverse pt-4">
                    <button type="submit" class="flex-1 btn-primary text-white py-3 rounded-lg font-semibold">
                        Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
                    </button>
                    <button type="button" onclick="hideAddAnnouncementModal()" class="flex-1 bg-gray-500 text-white py-3 rounded-lg font-semibold">
                        Ø¥Ù„ØºØ§Ø¡
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBT4YJcnZZmUhKVvs7iMp5mdAeWRjixEfI",
            authDomain: "platform-fd979.firebaseapp.com",
            projectId: "platform-fd979",
            storageBucket: "platform-fd979.firebasestorage.app",
            messagingSenderId: "184754007748",
            appId: "1:184754007748:web:a849462d9cb2bdb3a6e391",
            measurementId: "G-9FB64YHKM3"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        // Global Variables
        let currentUser = null;
        let isAdmin = false;

        // Utility Functions
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                warning: 'bg-yellow-500',
                info: 'bg-blue-500'
            };
            
            notification.className = `notification ${colors[type]} text-white px-6 py-3 rounded-lg shadow-lg max-w-sm`;
            notification.textContent = message;
            
            const container = document.getElementById('notifications');
            container.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 4000);
        }

        // Navigation Functions
        function showSection(sectionName) {
            // Hide all sections
            const sections = ['dashboardSection', 'coursesSection', 'quizSection', 'certificatesSection'];
            sections.forEach(section => {
                const element = document.getElementById(section);
                if (element) element.classList.add('hidden');
            });
            
            // Show selected section
            const targetSection = document.getElementById(sectionName + 'Section');
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }
            
            // Update navigation buttons - find the clicked button
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('bg-blue-50', 'text-blue-600');
                btn.classList.add('text-gray-700', 'hover:bg-gray-200');
            });
            
            // Find and highlight the correct button based on section name
            const buttonMap = {
                'dashboard': 0,
                'courses': 1,
                'quiz': 2,
                'certificates': 3
            };
            
            const buttons = document.querySelectorAll('.nav-btn');
            const activeButtonIndex = buttonMap[sectionName];
            if (buttons[activeButtonIndex]) {
                buttons[activeButtonIndex].classList.remove('text-gray-700', 'hover:bg-gray-200');
                buttons[activeButtonIndex].classList.add('bg-blue-50', 'text-blue-600');
            }

            // Load section-specific data
            if (sectionName === 'courses') {
                loadCourses();
            } else if (sectionName === 'certificates') {
                loadUserCertificates();
            }
        }

        function showAdminSection(sectionName) {
            // Hide all admin sections
            const sections = document.querySelectorAll('.admin-section');
            sections.forEach(section => section.classList.add('hidden'));
            
            // Show selected section
            const targetSection = document.getElementById('admin' + sectionName.charAt(0).toUpperCase() + sectionName.slice(1) + 'Section');
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }
            
            // Update navigation buttons
            document.querySelectorAll('.admin-nav-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.classList.add('text-white/70');
            });
            
            // Find and highlight the correct button based on section name
            const buttonMap = {
                'stats': 0,
                'courses': 1,
                'announcements': 2,
                'certificates': 3,
                'users': 4,
                'data': 5
            };
            
            const buttons = document.querySelectorAll('.admin-nav-btn');
            const activeButtonIndex = buttonMap[sectionName];
            if (buttons[activeButtonIndex]) {
                buttons[activeButtonIndex].classList.add('active');
                buttons[activeButtonIndex].classList.remove('text-white/70');
            }

            // Load section-specific data
            if (sectionName === 'courses') {
                loadAdminCourses();
            } else if (sectionName === 'announcements') {
                loadAdminAnnouncements();
            } else if (sectionName === 'certificates') {
                loadAdminCertificates();
            } else if (sectionName === 'users') {
                loadAdminUsers();
            } else if (sectionName === 'data') {
                loadAdminData();
            } else if (sectionName === 'stats') {
                updateAdminStats();
            }
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            
            document.getElementById('mainWebsite').classList.add('hidden');
            document.getElementById('loginScreen').classList.remove('hidden');
            showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­', 'info');
        }

        // Admin Functions
        function showAdminLogin() {
            document.getElementById('adminLoginModal').classList.remove('hidden');
        }

        function hideAdminLogin() {
            document.getElementById('adminLoginModal').classList.add('hidden');
            document.getElementById('adminLoginForm').reset();
        }

        function logoutAdmin() {
            isAdmin = false;
            document.getElementById('adminPanel').classList.add('hidden');
            document.getElementById('loginScreen').classList.remove('hidden');
            showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ Ø§Ù„Ù…Ø¯ÙŠØ±', 'info');
        }

        // Platform Data
        let platformData = {
            courses: [],
            announcements: [],
            registrations: [],
            certificateRequests: [],
            approvedCertificates: []
        };

        // Firebase Database Functions
        async function initializeDefaultData() {
            try {
                // Check if courses exist
                const coursesSnapshot = await db.collection('courses').get();
                if (coursesSnapshot.empty) {
                    // Add default courses
                    const defaultCourses = [
                        {
                            id: 'ai-students',
                            title: 'Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„Ù„Ø·Ù„Ø§Ø¨',
                            description: 'ØªØ¹Ù„Ù… Ø£Ø³Ø§Ø³ÙŠØ§Øª ÙˆØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ø¨Ø³Ø·Ø© ÙˆÙ…Ù…ØªØ¹Ø©',
                            instructor: 'Ø¯. Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ù„Ø®Ø¨ÙŠØ±',
                            lessons: 12,
                            hours: 8,
                            price: 299,
                            color: 'blue',
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        },
                        {
                            id: 'virtual-character',
                            title: 'ØªØµÙ…ÙŠÙ… Ø´Ø®ØµÙŠØ© Ø§ÙØªØ±Ø§Ø¶ÙŠØ©',
                            description: 'Ø¥Ù†Ø´Ø§Ø¡ ÙˆØªØ·ÙˆÙŠØ± Ø´Ø®ØµÙŠØ§Øª Ø°ÙƒÙŠØ© ØªÙØ§Ø¹Ù„ÙŠØ©',
                            instructor: 'Ø£. Ø³Ø§Ø±Ø© Ø£Ø­Ù…Ø¯ Ø§Ù„Ù…ØµÙ…Ù…Ø©',
                            lessons: 8,
                            hours: 6,
                            price: 199,
                            color: 'green',
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        },
                        {
                            id: 'ai-designers',
                            title: 'Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„Ù„Ù…ØµÙ…Ù…ÙŠÙ†',
                            description: 'ØªØµÙ…ÙŠÙ… Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ Ø¨Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ',
                            instructor: 'Ù…. Ø®Ø§Ù„Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ù…Ø·ÙˆØ±',
                            lessons: 10,
                            hours: 7,
                            price: 249,
                            color: 'purple',
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        }
                    ];

                    for (const course of defaultCourses) {
                        await db.collection('courses').doc(course.id).set(course);
                    }
                }

                // Check if announcements exist
                const announcementsSnapshot = await db.collection('announcements').get();
                if (announcementsSnapshot.empty) {
                    await db.collection('announcements').add({
                        title: 'Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙƒÙ… ÙÙŠ Ù…Ù†ØµØ© Ù…ÙˆØ±ÙˆÙƒØ³',
                        content: 'Ù†Ø±Ø­Ø¨ Ø¨Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨ ÙÙŠ Ù…Ù†ØµØ© Ù…ÙˆØ±ÙˆÙƒØ³ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ù„ØªØ¯Ø±ÙŠØ¨ Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ',
                        type: 'info',
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                }
            } catch (error) {
                console.error('Error initializing default data:', error);
            }
        }

        // Load platform data from Firebase
        async function loadPlatformData() {
            try {
                // Load courses
                const coursesSnapshot = await db.collection('courses').orderBy('createdAt', 'desc').get();
                platformData.courses = coursesSnapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));

                // Load announcements
                const announcementsSnapshot = await db.collection('announcements').orderBy('createdAt', 'desc').get();
                platformData.announcements = announcementsSnapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));

                // Load registrations
                const registrationsSnapshot = await db.collection('registrations').orderBy('registrationDate', 'desc').get();
                platformData.registrations = registrationsSnapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));

                // Load certificate requests
                const certificateRequestsSnapshot = await db.collection('certificateRequests').orderBy('requestDate', 'desc').get();
                platformData.certificateRequests = certificateRequestsSnapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));

                // Load approved certificates
                const approvedCertificatesSnapshot = await db.collection('approvedCertificates').orderBy('issueDate', 'desc').get();
                platformData.approvedCertificates = approvedCertificatesSnapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));

            } catch (error) {
                console.error('Error loading platform data:', error);
                showNotification('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
            }
        }

        // Save user to Firebase
        async function saveUser(userData) {
            try {
                await db.collection('users').doc(userData.email).set({
                    ...userData,
                    lastActive: firebase.firestore.FieldValue.serverTimestamp()
                }, { merge: true });
            } catch (error) {
                console.error('Error saving user:', error);
            }
        }

        // Load courses
        function loadCourses() {
            const coursesList = document.getElementById('coursesList');
            if (!coursesList) return;

            coursesList.innerHTML = '';
            
            platformData.courses.forEach(course => {
                const colorClasses = {
                    blue: 'from-blue-500 to-blue-600',
                    green: 'from-green-500 to-green-600',
                    purple: 'from-purple-500 to-purple-600',
                    red: 'from-red-500 to-red-600',
                    yellow: 'from-yellow-500 to-yellow-600'
                };

                const courseDiv = document.createElement('div');
                courseDiv.className = 'bg-white rounded-2xl shadow-lg overflow-hidden card-hover';
                courseDiv.innerHTML = `
                    <div class="bg-gradient-to-r ${colorClasses[course.color] || colorClasses.blue} text-white p-6">
                        <div class="flex items-center justify-between">
                            <div class="text-4xl">ğŸ“</div>
                            <div class="text-left">
                                <p class="text-sm opacity-90">${course.lessons} Ø¯Ø±ÙˆØ³ â€¢ ${course.hours} Ø³Ø§Ø¹Ø§Øª</p>
                                <p class="text-2xl font-bold">${course.price} Ø±ÙŠØ§Ù„</p>
                            </div>
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">${course.title}</h3>
                        <p class="text-gray-600 mb-4">${course.description}</p>
                        <p class="text-gray-500 text-sm mb-6">Ø§Ù„Ù…Ø¯Ø±Ø¨: ${course.instructor}</p>
                        <button onclick="registerForCourse('${course.id}')" class="w-full bg-green-500 hover:bg-green-600 text-white py-3 rounded-lg font-semibold transition-all">
                            Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ø§Ù„Ø¯ÙˆØ±Ø©
                        </button>
                    </div>
                `;
                coursesList.appendChild(courseDiv);
            });
        }

        // Register for course
        async function registerForCourse(courseId) {
            if (!currentUser) {
                showNotification('ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }

            const course = platformData.courses.find(c => c.id === courseId);
            if (!course) return;

            try {
                // Check if already registered
                const existingRegQuery = await db.collection('registrations')
                    .where('courseId', '==', courseId)
                    .where('email', '==', currentUser.email)
                    .get();

                if (!existingRegQuery.empty) {
                    showNotification('Ø£Ù†Øª Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙˆØ±Ø©!', 'warning');
                    return;
                }

                // Add registration to Firebase
                const registration = {
                    courseId: courseId,
                    courseName: course.title,
                    studentName: currentUser.name,
                    email: currentUser.email,
                    phone: currentUser.phone,
                    registrationDate: firebase.firestore.FieldValue.serverTimestamp()
                };

                await db.collection('registrations').add(registration);
                
                // Update local data
                platformData.registrations.push({
                    id: 'temp-' + Date.now(),
                    ...registration,
                    registrationDate: new Date().toISOString()
                });
                
                showNotification('ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ø§Ù„Ø¯ÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            } catch (error) {
                console.error('Error registering for course:', error);
                showNotification('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰', 'error');
            }
        }

        // Request certificate
        async function requestCertificate(courseId) {
            if (!currentUser) {
                showNotification('ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }

            const course = platformData.courses.find(c => c.id === courseId);
            if (!course) return;

            try {
                // Check if registered in course
                const registrationQuery = await db.collection('registrations')
                    .where('courseId', '==', courseId)
                    .where('email', '==', currentUser.email)
                    .get();

                if (registrationQuery.empty) {
                    showNotification('ÙŠØ¬Ø¨ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ø§Ù„Ø¯ÙˆØ±Ø© Ø£ÙˆÙ„Ø§Ù‹', 'error');
                    return;
                }

                // Check if already requested
                const existingRequestQuery = await db.collection('certificateRequests')
                    .where('courseId', '==', courseId)
                    .where('email', '==', currentUser.email)
                    .get();

                if (!existingRequestQuery.empty) {
                    showNotification('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹', 'warning');
                    return;
                }

                // Add certificate request to Firebase
                const request = {
                    courseId: courseId,
                    courseName: course.title,
                    instructor: course.instructor,
                    studentName: currentUser.name,
                    email: currentUser.email,
                    requestDate: firebase.firestore.FieldValue.serverTimestamp(),
                    status: 'pending'
                };

                await db.collection('certificateRequests').add(request);
                
                // Update local data
                platformData.certificateRequests.push({
                    id: 'temp-' + Date.now(),
                    ...request,
                    requestDate: new Date().toISOString()
                });
                
                showNotification('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', 'success');
                loadUserCertificates();
            } catch (error) {
                console.error('Error requesting certificate:', error);
                showNotification('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰', 'error');
            }
        }

        // Load user certificates
        function loadUserCertificates() {
            if (!currentUser) return;

            // Load available certificates
            const availableContainer = document.getElementById('availableCertificates');
            if (availableContainer) {
                availableContainer.innerHTML = '';
                const userRegistrations = platformData.registrations.filter(r => r.email === currentUser.email);
                
                if (userRegistrations.length === 0) {
                    availableContainer.innerHTML = '<p class="text-gray-500 text-center py-8">ÙŠØ¬Ø¨ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø·Ù„Ø¨ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª</p>';
                } else {
                    userRegistrations.forEach(registration => {
                        const course = platformData.courses.find(c => c.id === registration.courseId);
                        if (!course) return;

                        const hasRequested = platformData.certificateRequests.some(r => 
                            r.courseId === registration.courseId && r.email === currentUser.email
                        );

                        const hasApproved = platformData.approvedCertificates.some(c => 
                            c.courseId === registration.courseId && c.email === currentUser.email
                        );

                        const div = document.createElement('div');
                        div.className = 'bg-white p-6 rounded-xl shadow-lg';
                        div.innerHTML = `
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="text-lg font-semibold text-gray-800">${course.title}</h4>
                                    <p class="text-gray-600">${course.instructor}</p>
                                    <p class="text-sm text-gray-500">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„: ${new Date(registration.registrationDate).toLocaleDateString('ar')}</p>
                                </div>
                                <div>
                                    ${hasApproved ? 
                                        '<span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-semibold">ØªÙ… Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯</span>' :
                                        hasRequested ? 
                                            '<span class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-semibold">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</span>' :
                                            `<button onclick="requestCertificate('${course.id}')" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold transition-all">Ø·Ù„Ø¨ Ø´Ù‡Ø§Ø¯Ø©</button>`
                                    }
                                </div>
                            </div>
                        `;
                        availableContainer.appendChild(div);
                    });
                }
            }

            // Load pending certificates
            const pendingContainer = document.getElementById('pendingCertificatesList');
            if (pendingContainer) {
                pendingContainer.innerHTML = '';
                const pending = platformData.certificateRequests.filter(r => r.email === currentUser.email);
                
                if (pending.length === 0) {
                    pendingContainer.innerHTML = '<p class="text-gray-500 text-center py-8">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ø¹Ù„Ù‚Ø©</p>';
                } else {
                    pending.forEach(request => {
                        const div = document.createElement('div');
                        div.className = 'bg-yellow-50 border border-yellow-200 rounded-lg p-6';
                        div.innerHTML = `
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="font-semibold text-gray-800">${request.courseName}</h4>
                                    <p class="text-sm text-gray-600">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨: ${new Date(request.requestDate).toLocaleDateString('ar')}</p>
                                </div>
                                <div class="text-yellow-600 text-center">
                                    <i class="fas fa-clock text-2xl mb-1"></i>
                                    <p class="text-xs">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</p>
                                </div>
                            </div>
                        `;
                        pendingContainer.appendChild(div);
                    });
                }
            }

            // Load approved certificates
            const approvedContainer = document.getElementById('userApprovedCertificates');
            if (approvedContainer) {
                approvedContainer.innerHTML = '';
                const approved = platformData.approvedCertificates.filter(c => c.email === currentUser.email);
                
                if (approved.length === 0) {
                    approvedContainer.innerHTML = '<p class="text-gray-500 text-center py-8">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø´Ù‡Ø§Ø¯Ø§Øª Ù…Ø¹ØªÙ…Ø¯Ø© Ø¨Ø¹Ø¯</p>';
                } else {
                    approved.forEach(certificate => {
                        const div = document.createElement('div');
                        div.className = 'certificate-template rounded-xl p-8 text-white relative overflow-hidden';
                        div.innerHTML = `
                            <div class="text-center relative z-10">
                                <div class="text-5xl mb-4">ğŸ†</div>
                                <h2 class="text-3xl font-bold mb-4">Ø´Ù‡Ø§Ø¯Ø© Ø¥ØªÙ…Ø§Ù…</h2>
                                <h3 class="text-xl mb-6">Ù…Ù†ØµØ© Ù…ÙˆØ±ÙˆÙƒØ³ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</h3>
                                
                                <div class="bg-white/20 rounded-lg p-6 mb-6">
                                    <p class="text-lg mb-2">Ù†Ø´Ù‡Ø¯ Ø¨Ø£Ù†</p>
                                    <h4 class="text-2xl font-bold mb-4">${certificate.studentName}</h4>
                                    <p class="text-lg mb-2">Ù‚Ø¯ Ø£ØªÙ… Ø¨Ù†Ø¬Ø§Ø­ Ø¯ÙˆØ±Ø©</p>
                                    <h5 class="text-xl font-semibold mb-4">${certificate.courseName}</h5>
                                    <p class="text-sm">ØªØ­Øª Ø¥Ø´Ø±Ø§Ù: ${certificate.instructor}</p>
                                </div>
                                
                                <div class="flex justify-between items-end text-sm">
                                    <div>
                                        <p>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±</p>
                                        <p class="font-semibold">${new Date(certificate.issueDate).toLocaleDateString('ar')}</p>
                                    </div>
                                    <div>
                                        <p>Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ù†ØµØ©</p>
                                        <p class="font-semibold">Ù…. Ø¨Ø´Ø§Ø± Ø¹Ù†ÙŠØ²Ø§Ù†</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="certificate-seal">
                                <i class="fas fa-star text-2xl text-yellow-800"></i>
                            </div>
                        `;
                        approvedContainer.appendChild(div);
                    });
                }
            }
        }

        // Admin Course Management
        function loadAdminCourses() {
            const coursesList = document.getElementById('adminCoursesList');
            if (!coursesList) return;

            coursesList.innerHTML = '';
            
            platformData.courses.forEach(course => {
                const courseDiv = document.createElement('div');
                courseDiv.className = 'course-card rounded-xl p-6 text-white';
                courseDiv.innerHTML = `
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <h4 class="text-lg font-semibold">${course.title}</h4>
                            <p class="text-white/70 text-sm">${course.instructor}</p>
                        </div>
                        <div class="flex space-x-2 space-x-reverse">
                            <button onclick="editCourse('${course.id}')" class="btn-warning text-white px-3 py-1 rounded text-sm">
                                <i class="fas fa-edit mr-1"></i>ØªØ¹Ø¯ÙŠÙ„
                            </button>
                            <button onclick="deleteCourse('${course.id}')" class="btn-danger text-white px-3 py-1 rounded text-sm">
                                <i class="fas fa-trash mr-1"></i>Ø­Ø°Ù
                            </button>
                        </div>
                    </div>
                    <p class="text-white/80 text-sm mb-3">${course.description}</p>
                    <div class="flex justify-between text-sm text-white/70">
                        <span>${course.lessons} Ø¯Ø±ÙˆØ³</span>
                        <span>${course.hours} Ø³Ø§Ø¹Ø§Øª</span>
                        <span>${course.price} Ø±ÙŠØ§Ù„</span>
                    </div>
                `;
                coursesList.appendChild(courseDiv);
            });
        }

        function showAddCourseModal() {
            document.getElementById('addCourseModal').classList.remove('hidden');
        }

        function hideAddCourseModal() {
            document.getElementById('addCourseModal').classList.add('hidden');
            document.getElementById('addCourseForm').reset();
        }

        async function deleteCourse(courseId) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙˆØ±Ø©ØŸ')) {
                try {
                    await db.collection('courses').doc(courseId).delete();
                    platformData.courses = platformData.courses.filter(c => c.id !== courseId);
                    loadAdminCourses();
                    showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¯ÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                } catch (error) {
                    console.error('Error deleting course:', error);
                    showNotification('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø¯ÙˆØ±Ø©', 'error');
                }
            }
        }

        // Admin Announcements Management
        function loadAdminAnnouncements() {
            const announcementsList = document.getElementById('adminAnnouncementsList');
            if (!announcementsList) return;

            announcementsList.innerHTML = '';
            
            platformData.announcements.forEach(announcement => {
                const typeColors = {
                    info: 'bg-blue-500/20 border-blue-500/30',
                    success: 'bg-green-500/20 border-green-500/30',
                    warning: 'bg-yellow-500/20 border-yellow-500/30',
                    error: 'bg-red-500/20 border-red-500/30'
                };

                const announcementDiv = document.createElement('div');
                announcementDiv.className = `${typeColors[announcement.type]} border rounded-xl p-6 text-white`;
                announcementDiv.innerHTML = `
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <h4 class="text-lg font-semibold">${announcement.title}</h4>
                            <p class="text-white/70 text-sm">${new Date(announcement.date).toLocaleDateString('ar')}</p>
                        </div>
                        <div class="flex space-x-2 space-x-reverse">
                            <button onclick="editAnnouncement('${announcement.id}')" class="btn-warning text-white px-3 py-1 rounded text-sm">
                                <i class="fas fa-edit mr-1"></i>ØªØ¹Ø¯ÙŠÙ„
                            </button>
                            <button onclick="deleteAnnouncement('${announcement.id}')" class="btn-danger text-white px-3 py-1 rounded text-sm">
                                <i class="fas fa-trash mr-1"></i>Ø­Ø°Ù
                            </button>
                        </div>
                    </div>
                    <p class="text-white/90">${announcement.content}</p>
                `;
                announcementsList.appendChild(announcementDiv);
            });
        }

        function showAddAnnouncementModal() {
            document.getElementById('addAnnouncementModal').classList.remove('hidden');
        }

        function hideAddAnnouncementModal() {
            document.getElementById('addAnnouncementModal').classList.add('hidden');
            document.getElementById('addAnnouncementForm').reset();
        }

        async function deleteAnnouncement(announcementId) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ØŸ')) {
                try {
                    await db.collection('announcements').doc(announcementId).delete();
                    platformData.announcements = platformData.announcements.filter(a => a.id !== announcementId);
                    loadAdminAnnouncements();
                    showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¨Ù†Ø¬Ø§Ø­', 'success');
                } catch (error) {
                    console.error('Error deleting announcement:', error);
                    showNotification('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†', 'error');
                }
            }
        }

        // Admin certificate functions
        function loadAdminCertificates() {
            const pendingContainer = document.getElementById('pendingCertificatesAdmin');
            const approvedContainer = document.getElementById('approvedCertificatesAdmin');

            if (pendingContainer) {
                pendingContainer.innerHTML = '';
                
                if (platformData.certificateRequests.length === 0) {
                    pendingContainer.innerHTML = '<p class="text-white/70 text-center py-4">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø´Ù‡Ø§Ø¯Ø§Øª Ù…Ø¹Ù„Ù‚Ø©</p>';
                } else {
                    platformData.certificateRequests.forEach(request => {
                        const div = document.createElement('div');
                        div.className = 'bg-white/10 rounded-lg p-4 flex items-center justify-between';
                        div.innerHTML = `
                            <div>
                                <h4 class="text-white font-semibold">${request.studentName}</h4>
                                <p class="text-white/70 text-sm">${request.courseName}</p>
                                <p class="text-white/50 text-xs">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨: ${new Date(request.requestDate).toLocaleDateString('ar')}</p>
                            </div>
                            <div class="flex space-x-2 space-x-reverse">
                                <button onclick="approveCertificate('${request.id}')" class="btn-primary text-white px-3 py-1 rounded text-sm">
                                    Ø§Ø¹ØªÙ…Ø§Ø¯
                                </button>
                                <button onclick="rejectCertificate('${request.id}')" class="btn-danger text-white px-3 py-1 rounded text-sm">
                                    Ø±ÙØ¶
                                </button>
                            </div>
                        `;
                        pendingContainer.appendChild(div);
                    });
                }
            }

            if (approvedContainer) {
                approvedContainer.innerHTML = '';
                
                if (platformData.approvedCertificates.length === 0) {
                    approvedContainer.innerHTML = '<p class="text-white/70 text-center py-4">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø´Ù‡Ø§Ø¯Ø§Øª Ù…Ø¹ØªÙ…Ø¯Ø©</p>';
                } else {
                    platformData.approvedCertificates.forEach(certificate => {
                        const div = document.createElement('div');
                        div.className = 'bg-white/10 rounded-lg p-4';
                        div.innerHTML = `
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="text-white font-semibold">${certificate.studentName}</h4>
                                    <p class="text-white/70 text-sm">${certificate.courseName}</p>
                                    <p class="text-white/50 text-xs">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±: ${new Date(certificate.issueDate).toLocaleDateString('ar')}</p>
                                </div>
                                <div class="text-yellow-400">
                                    <i class="fas fa-certificate text-2xl"></i>
                                </div>
                            </div>
                        `;
                        approvedContainer.appendChild(div);
                    });
                }
            }
        }

        async function approveCertificate(requestId) {
            try {
                const request = platformData.certificateRequests.find(r => r.id === requestId);
                if (!request) return;

                // Create approved certificate in Firebase
                const certificate = {
                    courseId: request.courseId,
                    courseName: request.courseName,
                    instructor: request.instructor,
                    studentName: request.studentName,
                    email: request.email,
                    issueDate: firebase.firestore.FieldValue.serverTimestamp()
                };

                await db.collection('approvedCertificates').add(certificate);
                await db.collection('certificateRequests').doc(requestId).delete();

                // Update local data
                platformData.approvedCertificates.push({
                    id: 'temp-' + Date.now(),
                    ...certificate,
                    issueDate: new Date().toISOString()
                });
                platformData.certificateRequests = platformData.certificateRequests.filter(r => r.id !== requestId);
                
                loadAdminCertificates();
                updateAdminStats();
                showNotification('ØªÙ… Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
            } catch (error) {
                console.error('Error approving certificate:', error);
                showNotification('Ø®Ø·Ø£ ÙÙŠ Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©', 'error');
            }
        }

        async function rejectCertificate(requestId) {
            try {
                await db.collection('certificateRequests').doc(requestId).delete();
                platformData.certificateRequests = platformData.certificateRequests.filter(r => r.id !== requestId);
                loadAdminCertificates();
                updateAdminStats();
                showNotification('ØªÙ… Ø±ÙØ¶ Ø·Ù„Ø¨ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©', 'info');
            } catch (error) {
                console.error('Error rejecting certificate:', error);
                showNotification('Ø®Ø·Ø£ ÙÙŠ Ø±ÙØ¶ Ø§Ù„Ø·Ù„Ø¨', 'error');
            }
        }

        // Update admin statistics
        async function updateAdminStats() {
            try {
                // Get users count
                const usersSnapshot = await db.collection('users').get();
                document.getElementById('totalUsersCount').textContent = usersSnapshot.size;
                
                // Update other stats from loaded data
                document.getElementById('totalRegistrationsCount').textContent = platformData.registrations.length;
                document.getElementById('pendingCertificatesCount').textContent = platformData.certificateRequests.length;
                document.getElementById('totalCertificatesCount').textContent = platformData.approvedCertificates.length;
            } catch (error) {
                console.error('Error updating stats:', error);
                // Fallback to local data
                document.getElementById('totalUsersCount').textContent = '0';
                document.getElementById('totalRegistrationsCount').textContent = platformData.registrations.length;
                document.getElementById('pendingCertificatesCount').textContent = platformData.certificateRequests.length;
                document.getElementById('totalCertificatesCount').textContent = platformData.approvedCertificates.length;
            }
        }

        // Load admin users
        async function loadAdminUsers() {
            const usersList = document.getElementById('usersList');
            
            if (!usersList) return;
            
            try {
                const usersSnapshot = await db.collection('users').orderBy('lastActive', 'desc').get();
                usersList.innerHTML = '';
                
                if (usersSnapshot.empty) {
                    usersList.innerHTML = '<p class="text-white/70 text-center py-4">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…Ø³Ø¬Ù„ÙŠÙ†</p>';
                    return;
                }
                
                usersSnapshot.docs.forEach(doc => {
                    const user = doc.data();
                    const userDiv = document.createElement('div');
                    userDiv.className = 'bg-white/10 rounded-lg p-4 flex items-center justify-between';
                    
                    const lastActive = user.lastActive ? user.lastActive.toDate() : new Date(user.loginDate);
                    
                    userDiv.innerHTML = `
                        <div>
                            <h4 class="text-white font-semibold">${user.name}</h4>
                            <p class="text-white/70 text-sm">${user.email}</p>
                            <p class="text-white/50 text-xs">Ø¢Ø®Ø± Ù†Ø´Ø§Ø·: ${lastActive.toLocaleDateString('ar')}</p>
                        </div>
                        <div class="flex space-x-2 space-x-reverse">
                            <button onclick="deleteUser('${doc.id}')" class="btn-danger text-white px-3 py-1 rounded text-sm">
                                <i class="fas fa-trash mr-1"></i>Ø­Ø°Ù
                            </button>
                        </div>
                    `;
                    usersList.appendChild(userDiv);
                });
            } catch (error) {
                console.error('Error loading users:', error);
                usersList.innerHTML = '<p class="text-white/70 text-center py-4">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</p>';
            }
        }

        // Load admin data management
        async function loadAdminData() {
            await loadRegistrationsData();
            await loadAllUserData();
            updateDetailedStats();
        }

        // Load registrations data
        async function loadRegistrationsData() {
            const registrationsList = document.getElementById('registrationsList');
            if (!registrationsList) return;

            registrationsList.innerHTML = '';
            
            if (platformData.registrations.length === 0) {
                registrationsList.innerHTML = '<p class="text-white/70 text-center py-4">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ³Ø¬ÙŠÙ„Ø§Øª</p>';
                return;
            }

            platformData.registrations.forEach(registration => {
                const div = document.createElement('div');
                div.className = 'bg-white/10 rounded-lg p-4 flex items-center justify-between';
                
                const registrationDate = registration.registrationDate ? 
                    (typeof registration.registrationDate === 'string' ? 
                        new Date(registration.registrationDate) : 
                        registration.registrationDate.toDate()) : 
                    new Date();

                div.innerHTML = `
                    <div>
                        <h4 class="text-white font-semibold">${registration.studentName}</h4>
                        <p class="text-white/70 text-sm">${registration.courseName}</p>
                        <p class="text-white/50 text-xs">Ø§Ù„Ø¨Ø±ÙŠØ¯: ${registration.email}</p>
                        <p class="text-white/50 text-xs">Ø§Ù„Ù‡Ø§ØªÙ: ${registration.phone}</p>
                        <p class="text-white/50 text-xs">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„: ${registrationDate.toLocaleDateString('ar')}</p>
                    </div>
                    <div class="flex space-x-2 space-x-reverse">
                        <button onclick="deleteRegistration('${registration.id}')" class="btn-danger text-white px-3 py-1 rounded text-sm">
                            <i class="fas fa-trash mr-1"></i>Ø­Ø°Ù
                        </button>
                    </div>
                `;
                registrationsList.appendChild(div);
            });
        }

        // Load all user data
        async function loadAllUserData() {
            const allUserDataList = document.getElementById('allUserDataList');
            if (!allUserDataList) return;

            try {
                const usersSnapshot = await db.collection('users').orderBy('lastActive', 'desc').get();
                allUserDataList.innerHTML = '';
                
                if (usersSnapshot.empty) {
                    allUserDataList.innerHTML = '<p class="text-white/70 text-center py-4">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</p>';
                    return;
                }
                
                usersSnapshot.docs.forEach(doc => {
                    const user = doc.data();
                    const div = document.createElement('div');
                    div.className = 'bg-white/10 rounded-lg p-4';
                    
                    const lastActive = user.lastActive ? user.lastActive.toDate() : new Date(user.loginDate);
                    
                    // Get user's registrations
                    const userRegistrations = platformData.registrations.filter(r => r.email === user.email);
                    const userCertificates = platformData.approvedCertificates.filter(c => c.email === user.email);
                    const userCertificateRequests = platformData.certificateRequests.filter(r => r.email === user.email);

                    div.innerHTML = `
                        <div class="flex items-center justify-between mb-3">
                            <div>
                                <h4 class="text-white font-semibold">${user.name}</h4>
                                <p class="text-white/70 text-sm">${user.email}</p>
                                <p class="text-white/50 text-xs">Ø§Ù„Ù‡Ø§ØªÙ: ${user.phone || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                                <p class="text-white/50 text-xs">Ø¢Ø®Ø± Ù†Ø´Ø§Ø·: ${lastActive.toLocaleDateString('ar')}</p>
                            </div>
                            <button onclick="deleteUserCompletely('${doc.id}', '${user.email}')" class="btn-danger text-white px-3 py-1 rounded text-sm">
                                <i class="fas fa-user-times mr-1"></i>Ø­Ø°Ù ÙƒØ§Ù…Ù„
                            </button>
                        </div>
                        <div class="grid grid-cols-3 gap-2 text-xs text-white/60">
                            <div class="bg-white/5 rounded p-2 text-center">
                                <div class="font-semibold">${userRegistrations.length}</div>
                                <div>ØªØ³Ø¬ÙŠÙ„Ø§Øª</div>
                            </div>
                            <div class="bg-white/5 rounded p-2 text-center">
                                <div class="font-semibold">${userCertificates.length}</div>
                                <div>Ø´Ù‡Ø§Ø¯Ø§Øª</div>
                            </div>
                            <div class="bg-white/5 rounded p-2 text-center">
                                <div class="font-semibold">${userCertificateRequests.length}</div>
                                <div>Ø·Ù„Ø¨Ø§Øª Ù…Ø¹Ù„Ù‚Ø©</div>
                            </div>
                        </div>
                    `;
                    allUserDataList.appendChild(div);
                });
            } catch (error) {
                console.error('Error loading all user data:', error);
                allUserDataList.innerHTML = '<p class="text-white/70 text-center py-4">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p>';
            }
        }

        // Update detailed statistics
        function updateDetailedStats() {
            document.getElementById('totalUsersDetailed').textContent = platformData.users?.length || 0;
            document.getElementById('totalRegistrationsDetailed').textContent = platformData.registrations.length;
            document.getElementById('totalCertificateRequestsDetailed').textContent = platformData.certificateRequests.length;
            document.getElementById('totalApprovedCertificatesDetailed').textContent = platformData.approvedCertificates.length;
        }

        // Delete user
        async function deleteUser(userId) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŸ')) {
                try {
                    await db.collection('users').doc(userId).delete();
                    loadAdminUsers();
                    showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­', 'success');
                } catch (error) {
                    console.error('Error deleting user:', error);
                    showNotification('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…', 'error');
                }
            }
        }

        // Delete user completely (all data)
        async function deleteUserCompletely(userId, userEmail) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡!')) {
                try {
                    // Delete user document
                    await db.collection('users').doc(userId).delete();
                    
                    // Delete user registrations
                    const registrationsQuery = await db.collection('registrations').where('email', '==', userEmail).get();
                    const registrationDeletePromises = registrationsQuery.docs.map(doc => doc.ref.delete());
                    await Promise.all(registrationDeletePromises);
                    
                    // Delete user certificate requests
                    const certificateRequestsQuery = await db.collection('certificateRequests').where('email', '==', userEmail).get();
                    const certificateRequestDeletePromises = certificateRequestsQuery.docs.map(doc => doc.ref.delete());
                    await Promise.all(certificateRequestDeletePromises);
                    
                    // Delete user approved certificates
                    const approvedCertificatesQuery = await db.collection('approvedCertificates').where('email', '==', userEmail).get();
                    const approvedCertificateDeletePromises = approvedCertificatesQuery.docs.map(doc => doc.ref.delete());
                    await Promise.all(approvedCertificateDeletePromises);
                    
                    // Update local data
                    platformData.registrations = platformData.registrations.filter(r => r.email !== userEmail);
                    platformData.certificateRequests = platformData.certificateRequests.filter(r => r.email !== userEmail);
                    platformData.approvedCertificates = platformData.approvedCertificates.filter(c => c.email !== userEmail);
                    
                    loadAdminData();
                    updateAdminStats();
                    showNotification('ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­', 'success');
                } catch (error) {
                    console.error('Error deleting user completely:', error);
                    showNotification('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…', 'error');
                }
            }
        }

        // Delete registration
        async function deleteRegistration(registrationId) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ØŸ')) {
                try {
                    await db.collection('registrations').doc(registrationId).delete();
                    platformData.registrations = platformData.registrations.filter(r => r.id !== registrationId);
                    loadRegistrationsData();
                    updateAdminStats();
                    showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­', 'success');
                } catch (error) {
                    console.error('Error deleting registration:', error);
                    showNotification('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„ØªØ³Ø¬ÙŠÙ„', 'error');
                }
            }
        }

        // Export registrations
        function exportRegistrations() {
            if (platformData.registrations.length === 0) {
                showNotification('Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ³Ø¬ÙŠÙ„Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±', 'warning');
                return;
            }

            const csvContent = "data:text/csv;charset=utf-8," 
                + "Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨,Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ,Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ,Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ±Ø©,ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„\n"
                + platformData.registrations.map(r => {
                    const date = r.registrationDate ? 
                        (typeof r.registrationDate === 'string' ? 
                            new Date(r.registrationDate) : 
                            r.registrationDate.toDate()) : 
                        new Date();
                    return `"${r.studentName}","${r.email}","${r.phone}","${r.courseName}","${date.toLocaleDateString('ar')}"`;
                }).join("\n");

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `registrations_${new Date().toISOString().split('T')[0]}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('ØªÙ… ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }

        // Export all user data
        async function exportAllUserData() {
            try {
                const usersSnapshot = await db.collection('users').get();
                if (usersSnapshot.empty) {
                    showNotification('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±', 'warning');
                    return;
                }

                let csvContent = "data:text/csv;charset=utf-8," 
                    + "Ø§Ù„Ø§Ø³Ù…,Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ,Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ,Ø¢Ø®Ø± Ù†Ø´Ø§Ø·,Ø¹Ø¯Ø¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„Ø§Øª,Ø¹Ø¯Ø¯ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª,Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©\n";

                usersSnapshot.docs.forEach(doc => {
                    const user = doc.data();
                    const userRegistrations = platformData.registrations.filter(r => r.email === user.email);
                    const userCertificates = platformData.approvedCertificates.filter(c => c.email === user.email);
                    const userCertificateRequests = platformData.certificateRequests.filter(r => r.email === user.email);
                    
                    const lastActive = user.lastActive ? user.lastActive.toDate() : new Date(user.loginDate);
                    
                    csvContent += `"${user.name}","${user.email}","${user.phone || ''}","${lastActive.toLocaleDateString('ar')}","${userRegistrations.length}","${userCertificates.length}","${userCertificateRequests.length}"\n`;
                });

                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", `all_user_data_${new Date().toISOString().split('T')[0]}.csv`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                showNotification('ØªÙ… ØªØµØ¯ÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
            } catch (error) {
                console.error('Error exporting all user data:', error);
                showNotification('Ø®Ø·Ø£ ÙÙŠ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
            }
        }

        // Clear all data
        async function clearAllData() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡!')) {
                if (confirm('ØªØ£ÙƒÙŠØ¯ Ø£Ø®ÙŠØ±: Ø³ÙŠØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„Ø§Øª ÙˆØ§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª!')) {
                    try {
                        // Delete all collections
                        const collections = ['users', 'registrations', 'certificateRequests', 'approvedCertificates'];
                        
                        for (const collectionName of collections) {
                            const snapshot = await db.collection(collectionName).get();
                            const deletePromises = snapshot.docs.map(doc => doc.ref.delete());
                            await Promise.all(deletePromises);
                        }
                        
                        // Clear local data
                        platformData.registrations = [];
                        platformData.certificateRequests = [];
                        platformData.approvedCertificates = [];
                        
                        loadAdminData();
                        updateAdminStats();
                        showNotification('ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
                    } catch (error) {
                        console.error('Error clearing all data:', error);
                        showNotification('Ø®Ø·Ø£ ÙÙŠ Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
                    }
                }
            }
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize default data in background
            initializeDefaultData().then(() => {
                return loadPlatformData();
            }).catch(error => {
                console.error('Error loading data:', error);
                // Continue with default data if Firebase fails
                platformData.courses = [
                    {
                        id: 'ai-students',
                        title: 'Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„Ù„Ø·Ù„Ø§Ø¨',
                        description: 'ØªØ¹Ù„Ù… Ø£Ø³Ø§Ø³ÙŠØ§Øª ÙˆØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ø¨Ø³Ø·Ø© ÙˆÙ…Ù…ØªØ¹Ø©',
                        instructor: 'Ø¯. Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ù„Ø®Ø¨ÙŠØ±',
                        lessons: 12,
                        hours: 8,
                        price: 299,
                        color: 'blue'
                    },
                    {
                        id: 'virtual-character',
                        title: 'ØªØµÙ…ÙŠÙ… Ø´Ø®ØµÙŠØ© Ø§ÙØªØ±Ø§Ø¶ÙŠØ©',
                        description: 'Ø¥Ù†Ø´Ø§Ø¡ ÙˆØªØ·ÙˆÙŠØ± Ø´Ø®ØµÙŠØ§Øª Ø°ÙƒÙŠØ© ØªÙØ§Ø¹Ù„ÙŠØ©',
                        instructor: 'Ø£. Ø³Ø§Ø±Ø© Ø£Ø­Ù…Ø¯ Ø§Ù„Ù…ØµÙ…Ù…Ø©',
                        lessons: 8,
                        hours: 6,
                        price: 199,
                        color: 'green'
                    },
                    {
                        id: 'ai-designers',
                        title: 'Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„Ù„Ù…ØµÙ…Ù…ÙŠÙ†',
                        description: 'ØªØµÙ…ÙŠÙ… Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ Ø¨Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ',
                        instructor: 'Ù…. Ø®Ø§Ù„Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ù…Ø·ÙˆØ±',
                        lessons: 10,
                        hours: 7,
                        price: 249,
                        color: 'purple'
                    }
                ];
            });
            
            // Check if user is already logged in
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('mainWebsite').classList.remove('hidden');
                document.getElementById('welcomeName').textContent = currentUser.name;
                document.getElementById('welcomeName2').textContent = currentUser.name;
                showSection('dashboard');
                loadCourses();
                loadUserCertificates();
            }

            // Login Form Handler
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const name = document.getElementById('studentName').value.trim();
                const phone = document.getElementById('studentPhone').value.trim();
                const email = document.getElementById('studentEmail').value.trim();
                
                if (!name || !phone || !email) {
                    showNotification('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„', 'error');
                    return;
                }
                
                // Create user object
                currentUser = {
                    name: name,
                    phone: phone,
                    email: email,
                    loginDate: new Date().toISOString()
                };
                
                // Save to localStorage for session
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                // Show main website
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('mainWebsite').classList.remove('hidden');
                document.getElementById('welcomeName').textContent = name;
                document.getElementById('welcomeName2').textContent = name;
                
                // Load data and show dashboard
                loadCourses();
                loadUserCertificates();
                showSection('dashboard');
                showNotification('Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…Ù†ØµØ© Ù…ÙˆØ±ÙˆÙƒØ³!', 'success');
                
                // Save user data to Firebase in background
                saveUser(currentUser).catch(error => {
                    console.error('Error saving user:', error);
                });
            });

            // Admin Login Form Handler
            document.getElementById('adminLoginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const username = document.getElementById('adminUsername').value.trim();
                const password = document.getElementById('adminPassword').value.trim();
                
                if (username === 'Bashar' && password === 'bbsshhaarr6405') {
                    isAdmin = true;
                    document.getElementById('adminLoginModal').classList.add('hidden');
                    document.getElementById('loginScreen').classList.add('hidden');
                    document.getElementById('adminPanel').classList.remove('hidden');
                    
                    // Show stats section by default
                    showAdminSection('stats');
                    updateAdminStats();
                    showNotification('Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…', 'success');
                } else {
                    showNotification('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©', 'error');
                }
            });

            // Add Course Form Handler
            document.getElementById('addCourseForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const title = document.getElementById('courseTitle').value.trim();
                const description = document.getElementById('courseDescription').value.trim();
                const instructor = document.getElementById('courseInstructor').value.trim();
                const lessons = parseInt(document.getElementById('courseLessons').value);
                const hours = parseInt(document.getElementById('courseHours').value);
                const price = parseInt(document.getElementById('coursePrice').value);
                
                const colors = ['blue', 'green', 'purple', 'red', 'yellow'];
                const randomColor = colors[Math.floor(Math.random() * colors.length)];
                
                try {
                    const newCourse = {
                        title: title,
                        description: description,
                        instructor: instructor,
                        lessons: lessons,
                        hours: hours,
                        price: price,
                        color: randomColor,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    };
                    
                    const docRef = await db.collection('courses').add(newCourse);
                    
                    // Update local data
                    platformData.courses.push({
                        id: docRef.id,
                        ...newCourse,
                        createdAt: new Date()
                    });
                    
                    hideAddCourseModal();
                    loadAdminCourses();
                    showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                } catch (error) {
                    console.error('Error adding course:', error);
                    showNotification('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙˆØ±Ø©', 'error');
                }
            });

            // Add Announcement Form Handler
            document.getElementById('addAnnouncementForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const title = document.getElementById('announcementTitle').value.trim();
                const content = document.getElementById('announcementContent').value.trim();
                const type = document.getElementById('announcementType').value;
                
                try {
                    const newAnnouncement = {
                        title: title,
                        content: content,
                        type: type,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    };
                    
                    const docRef = await db.collection('announcements').add(newAnnouncement);
                    
                    // Update local data
                    platformData.announcements.push({
                        id: docRef.id,
                        ...newAnnouncement,
                        createdAt: new Date()
                    });
                    
                    hideAddAnnouncementModal();
                    loadAdminAnnouncements();
                    showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¨Ù†Ø¬Ø§Ø­', 'success');
                } catch (error) {
                    console.error('Error adding announcement:', error);
                    showNotification('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†', 'error');
                }
            });
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97495651e7b441b7',t:'MTc1NjEwNjUzNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
